YUI.add("cookie-catcher",function(Y){function CookieCatcher(){this.expireTime=new Date((new Date).getTime()+864e5*Y.config.cookieConsent.consent_context_expiration_days),this.cookieLevelBuckets={required:Object.values(Y.config.cookieConsent.cookie_level_buckets.required),functional:Object.values(Y.config.cookieConsent.cookie_level_buckets.functional),advertising:Object.values(Y.config.cookieConsent.cookie_level_buckets.advertising)},this.cookieConsentEnabled=Y.config.flickr.flags.enable_cookie_consent}CookieCatcher.prototype.getCookieLevel=function(cookieName){return-1!==this.cookieLevelBuckets.required.indexOf(cookieName)?0:-1!==this.cookieLevelBuckets.functional.indexOf(cookieName)?1:-1!==this.cookieLevelBuckets.advertising.indexOf(cookieName)?2:null},CookieCatcher.prototype.setCookieIfAllowed=function(name,value,options){var cookieLevel,consentContext;this.cookieConsentEnabled&&Y.config.flickr.flags.requires_cookie_consent?(cookieLevel=this.getCookieLevel(name),consentContext=this.getCookieConsentContext(),(null===cookieLevel||cookieLevel<=consentContext.info.cookieBlock.level)&&Y.Cookie.set(name,value,options)):Y.Cookie.set(name,value,options)},CookieCatcher.prototype.getCookieConsentContext=function(){var cookieContext=Y.Cookie.get(Y.config.cookieConsent.consent_context_name),newCookieContext={managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}};if(cookieContext)try{newCookieContext=JSON.parse(cookieContext)}catch(err){Y.Cookie.set(Y.config.cookieConsent.consent_context_name,JSON.stringify(newCookieContext),{path:"/",domain:".flickr.com",expires:this.expireTime})}else Y.Cookie.set(Y.config.cookieConsent.consent_context_name,JSON.stringify(newCookieContext),{path:"/",domain:".flickr.com",expires:this.expireTime});return newCookieContext},CookieCatcher.prototype.handleConsentManagerChoice=function(){var json;try{json=window.truste.cma.callApi("getConsentDecision","flickr.com"),this.updateConsentContext(json.consentDecision-1)}catch(err){}},CookieCatcher.prototype.updateConsentContext=function(newLevel){var cookieConsentContext=this.getCookieConsentContext(cookieConsentContext);cookieConsentContext.info.cookieBlock.level!==newLevel&&(cookieConsentContext.changed=0,cookieConsentContext.info.cookieBlock.level=newLevel,Y.Cookie.set(Y.config.cookieConsent.consent_context_name,JSON.stringify(cookieConsentContext),{path:"/",domain:".flickr.com",expires:this.expireTime}),window.location.reload())},Y.CookieCatcher=CookieCatcher},"0.0.1",{requires:F.config.modules["cookie-catcher"].requires||[],optional:F.config.modules["cookie-catcher"].optional||[]});